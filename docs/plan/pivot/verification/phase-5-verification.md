# Phase 5 검증: 사이드바 네비게이션

검증일: ____-__-__
검증자: ________________

## 참조 문서

- 구현 계획: [05.phase-5-sidebar.md](../05.phase-5-sidebar.md)
- SRS: [srs.pivot.md](../../srs.pivot.md) (FR-P-004)
- 아키텍처: [00-1.architecture.md](../00-1.architecture.md) Section 3.2

---

## 1. 링크 파서 (link-parser.js) 검증

### 1.1 기본 링크 파싱

| # | 검증 항목 | 테스트 입력 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 1 | [ ] 표준 Markdown 링크 추출 | `[텍스트](./file.md)` | `./file.md` 추출 | |
| 2 | [ ] 앵커 포함 링크 (#이후 제거) | `[텍스트](./guide.md#section)` | `./guide.md` 추출 | |
| 3 | [ ] 쿼리 포함 링크 (?이후 제거) | `[텍스트](./file.md?v=2)` | `./file.md` 추출 | |
| 4 | [ ] 상대 경로 (./시작) | `[텍스트](./sub/file.md)` | 현재 디렉토리 기준 resolve | |
| 5 | [ ] 상대 경로 (../시작) | `[텍스트](../other/file.md)` | 상위 디렉토리 기준 resolve | |
| 6 | [ ] 상대 경로 (접두사 없음) | `[텍스트](sub/file.md)` | 현재 디렉토리 기준 resolve | |
| 7 | [ ] 절대 경로 (Unix) | `[텍스트](/docs/file.md)` | 파일시스템 루트 기준 | |
| 8 | [ ] 절대 경로 (Windows 드라이브) | `[텍스트](C:/docs/file.md)` | 그대로 사용 | |
| 9 | [ ] URL 인코딩 파일 경로 | `[텍스트](./my%20file.md)` | `./my file.md` (디코딩) | |
| 10 | [ ] 참조 링크 | `[텍스트][ref]` + `[ref]: ./path.md` | `./path.md` 추출 | |
| 11 | [ ] Wiki 링크 | `[[path/to/file]]` | `path/to/file.md` (.md 자동 추가) | |
| 12 | [ ] Wiki 링크 (확장자 포함) | `[[path/to/file.md]]` | `path/to/file.md` | |

### SRS 매핑: T-30 (앵커/쿼리), T-31 (URL 인코딩), T-42 (Wiki 링크), T-52 (참조 링크)

### 1.2 링크 제외 규칙

| # | 검증 항목 | 테스트 입력 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 13 | [ ] HTTP/HTTPS URL 제외 | `[외부](https://example.com)` | 파싱 결과에 미포함 | |
| 14 | [ ] mailto 링크 제외 | `[메일](mailto:a@b.com)` | 파싱 결과에 미포함 | |
| 15 | [ ] 앵커 전용 링크 제외 | `[섹션](#heading)` | 파싱 결과에 미포함 | |
| 16 | [ ] javascript: URI 제외 | `[악성](javascript:alert(1))` | 파싱 결과에 미포함 | |
| 17 | [ ] 비-Markdown 파일 제외 | `[이미지](./photo.png)` | 파싱 결과에 미포함 | |
| 18 | [ ] data URI 제외 | `[데이터](data:image/png;...)` | 파싱 결과에 미포함 | |

### 1.3 코드 블록 내 링크 제외

| # | 검증 항목 | 테스트 입력 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 19 | [ ] fenced 코드 블록 내 링크 제외 | ` ```\n[link](./file.md)\n``` ` | 트리에 미포함 | |
| 20 | [ ] 인라인 코드 내 링크 제외 | `` `[link](./file.md)` `` | 트리에 미포함 | |
| 21 | [ ] HTML 주석 내 링크 제외 | `<!-- [link](./file.md) -->` | 트리에 미포함 | |

### SRS 매핑: T-29 (코드 블록 내 링크 제외)

---

## 2. 재귀 트리 빌드 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 22 | [ ] 기본 재귀 트리 빌드 | 2단계 링크 문서 | parent → child → grandchild 트리 | |
| 23 | [ ] 최대 깊이 제한 (depth <= 10) | 11단계 이상 링크 | depth 10에서 중단, null 반환 | |
| 24 | [ ] 대형 트리 200+ 파일 | 200개 이상 링크 | MAX_TREE_FILES 제한 적용 | |
| 25 | [ ] TreeNode 구조 정합성 | 빌드 결과 검사 | `{ path, title, exists, children }` | |
| 26 | [ ] 제목 추출 (frontmatter title) | YAML frontmatter 있는 문서 | title 필드 사용 | |
| 27 | [ ] 제목 추출 (H1 헤딩) | `# 가이드` 문서 | "가이드" 사용 | |
| 28 | [ ] 제목 추출 (fallback) | 제목 정보 없는 문서 | 파일명 (확장자 제외) 사용 | |
| 29 | [ ] 중복 링크 제거 | 같은 파일 2번 링크 | children에 1번만 포함 | |

### SRS 매핑: T-57 (대형 트리)

---

## 3. 순환 참조 방지 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 30 | [ ] 직접 순환 (A→A) | 자기 자신 링크 문서 | 무한 루프 없이 트리 완성 | |
| 31 | [ ] 간접 순환 (A→B→A) | 상호 링크 문서 | 두 번째 방문 시 null 반환 | |
| 32 | [ ] 깊은 순환 (A→B→C→A) | 3단계 순환 링크 | visited Set으로 감지, 정상 중단 | |
| 33 | [ ] visited Set 격리 | 형제 노드 간 visited 공유 안 됨 | `new Set(visited)` 복사 확인 | |

### SRS 매핑: T-15 (순환 참조)

---

## 4. 사이드바 UI 표시/숨김 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 34 | [ ] 링크 있는 문서 → 사이드바 표시 | filePath 모드, 링크 포함 문서 | 좌측 사이드바에 트리 표시 | |
| 35 | [ ] 링크 없는 문서 → 사이드바 숨김 | filePath 모드, 링크 없는 문서 | 사이드바 완전 숨김, 뷰어 전체 너비 | |
| 36 | [ ] content 모드 → 사이드바 숨김 | content만 제공 | 사이드바 완전 숨김 | |
| 37 | [ ] content+filePath → 사이드바 표시 | 두 파라미터 모두 제공 | filePath 기준 사이드바 | |

### SRS 매핑: T-12 (사이드바 표시), T-13 (사이드바 숨김), T-14 (content 모드)

---

## 5. 트리 항목 클릭 네비게이션 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 38 | [ ] 트리 항목 클릭 시 같은 창에서 문서 전환 | 사이드바 항목 클릭 | 새 창 안 열림, 같은 창에서 렌더링 교체 | |
| 39 | [ ] 현재 활성 항목 하이라이트 | 문서 이동 후 사이드바 확인 | 현재 문서 항목 강조 표시 | |
| 40 | [ ] 트리 구조 유지 (root-preserving) | 하위 문서 이동 후 확인 | 트리 재빌드 없이 하이라이트만 변경 | |
| 41 | [ ] scrollIntoView 자동 스크롤 | 긴 트리에서 하위 항목으로 이동 | 현재 항목이 보이는 위치로 스크롤 | |

### SRS 매핑: T-17 (트리 항목 클릭), T-41 (scrollIntoView)

---

## 6. 존재하지 않는 파일 처리 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 42 | [ ] 존재하지 않는 파일 → 회색 처리 | 삭제된 파일 링크 | 트리에 회색 텍스트로 표시 | |
| 43 | [ ] 존재하지 않는 파일 → 클릭 불가 | 회색 항목 클릭 시도 | 클릭 이벤트 무시 또는 비활성 | |
| 44 | [ ] `exists: false` 표시 | TreeNode 데이터 확인 | exists 필드 false | |

### SRS 매핑: T-16 (존재하지 않는 파일 링크)

---

## 7. 네비게이션 히스토리 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 45 | [ ] 뒤로가기 (Ctrl+Left) | 문서 A→B 이동 후 Ctrl+Left | 문서 A로 복귀 | |
| 46 | [ ] 앞으로가기 (Ctrl+Right) | 뒤로간 후 Ctrl+Right | 문서 B로 이동 | |
| 47 | [ ] 뒤로가기 후 새 이동 시 forward 제거 | A→B→뒤로→C | forward 스택 비워짐 (B 접근 불가) | |
| 48 | [ ] 히스토리 최대 크기 (50) | 51번 네비게이션 | 가장 오래된 항목 제거 | |
| 49 | [ ] 히스토리 빈 상태에서 뒤로가기 | 첫 문서에서 Ctrl+Left | 무동작 (에러 없음) | |

### SRS 매핑: T-34 (Ctrl+Left/Right), T-56 (forward 제거)

---

## 8. 사이드바 리사이즈 검증

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 50 | [ ] 사이드바 드래그 리사이즈 | 경계선 드래그 | 너비 변경됨 | |
| 51 | [ ] 리사이즈 결과 electron-store 저장 | 리사이즈 후 창 닫기 | sidebarWidth 값 저장됨 | |
| 52 | [ ] 새 창 열기 시 저장된 너비 복원 | 리사이즈 후 새 창 열기 | 이전 너비로 사이드바 표시 | |
| 53 | [ ] 최소 너비 제한 (150px) | 150px 미만 드래그 | 150px에서 고정 | |
| 54 | [ ] 최대 너비 제한 (창 50%) | 50% 초과 드래그 | 50%에서 클램프 | |
| 55 | [ ] Ctrl+B 사이드바 토글 | 토글 단축키 | 숨김/표시 전환 (애니메이션 200ms) | |

### SRS 매핑: T-40 (사이드바 너비 저장), T-45 (리사이즈 경계), T-50 (Ctrl+B 토글)

---

## 9. 심볼릭 링크 및 특수 케이스

| # | 검증 항목 | 확인 방법 | 기대 결과 | 결과 |
|---|-----------|-----------|-----------|------|
| 56 | [ ] 심볼릭 링크 파일 무시 | 심볼릭 링크 .md 파일 | fs.lstat 감지, 트리에서 제외 | |
| 57 | [ ] 확장자 없는 링크 → .md 자동 시도 | `[텍스트](./file)` + file.md 존재 | file.md로 해석 | |
| 58 | [ ] 확장자 없는 링크 → .md 없으면 무시 | `[텍스트](./file)` + file 존재 (비-md) | 무시 | |

### SRS 매핑: T-53 (심볼릭 링크)

---

## 10. 검증 결과 요약

| 항목 | 전체 | 통과 | 실패 | 미검증 |
|------|------|------|------|--------|
| 링크 파싱 (기본) | 12 | | | |
| 링크 제외 규칙 | 6 | | | |
| 코드 블록 내 링크 | 3 | | | |
| 재귀 트리 빌드 | 8 | | | |
| 순환 참조 방지 | 4 | | | |
| 사이드바 표시/숨김 | 4 | | | |
| 트리 항목 네비게이션 | 4 | | | |
| 존재하지 않는 파일 | 3 | | | |
| 네비게이션 히스토리 | 5 | | | |
| 사이드바 리사이즈 | 6 | | | |
| 심볼릭 링크/특수 | 3 | | | |
| **합계** | **58** | | | |

### 최종 판정

- [ ] **PASS**: 모든 검증 항목 통과
- [ ] **FAIL**: 실패 항목 존재 -> 수정 후 재검증 필요

실패 항목 (있을 경우):

| # | 항목 | 실패 사유 | 수정 조치 |
|---|------|-----------|-----------|
| | | | |
