# Step 20: Frontmatter Metadata Feature

## 전체 개요

MCP `open_markdown` / `update_markdown` 툴에 frontmatter 메타데이터 파라미터 3개(`project`, `docName`, `description`)를 추가하고, MCP 서버에서 YAML frontmatter를 자동 조합하여 content에 주입한다. Viewer에서는 frontmatter를 파싱하여 접을 수 있는 메타박스(metabox)로 표시한다.

## 목적

- AI 어시스턴트(Claude Desktop 등)가 MCP 호출 시 문서 메타데이터를 체계적으로 전달할 수 있도록 함
- Viewer에서 문서의 프로젝트, 이름, 설명, 생성일시 등을 한눈에 파악 가능
- `description` 파라미터를 강하게 유도하여 AI가 항상 문서 요약을 제공하도록 설계

## Phase 구성

| Phase | 문서 | 내용 |
|-------|------|------|
| Phase 1 | [01.phase-1-mcp-frontmatter.md](./01.phase-1-mcp-frontmatter.md) | MCP 파라미터 추가 + Frontmatter 자동 조합 |
| Phase 2 | [02.phase-2-viewer-metabox.md](./02.phase-2-viewer-metabox.md) | Viewer Frontmatter 파싱 및 메타박스 UI |
| Phase 3 | [03.phase-3-claude-md.md](./03.phase-3-claude-md.md) | CLAUDE.md 업데이트 |

## 새 파라미터 요약

| 파라미터 | 타입 | 필수 | 설명 |
|----------|------|------|------|
| `project` | `string` | optional | 프로젝트명 (예: "DocuLight", "MyApp") |
| `docName` | `string` | optional | 문서 이름/식별자 (예: "API Reference", "설계 문서") |
| `description` | `string` | optional (강하게 유도) | 문서 요약/설명. AI가 적극적으로 채우도록 description에 유도 문구 포함 |

## Frontmatter 자동 조합 규칙

1. `project`, `docName`, `description` 중 **하나라도 값이 있으면** frontmatter 블록을 자동 생성
2. `date` 필드는 항상 자동 추가 (ISO 8601 형식: `YYYY-MM-DDTHH:mm:ss`)
3. 기존 content에 이미 frontmatter(`---\n...\n---`)가 있으면 기존 값을 유지하되 새 값으로 **병합** (새 값이 우선)
4. frontmatter 블록은 content 최상단에 위치

### 생성 예시

```yaml
---
project: DocuLight
docName: API Reference
description: MCP 서버의 open_markdown 도구에 대한 상세 API 문서
date: 2026-02-27T14:30:00
---
```

## 메타박스 UI 동작

- frontmatter가 존재하면 content 상단에 접을 수 있는(collapsible) 메타박스 표시
- 기본 상태: **펼침(open)**
- Light/Dark 테마 모두 지원
- frontmatter 내용은 `marked.parse()`에 전달하지 않음 (별도 파싱)

## 영향 범위

### 수정 대상 파일

| 파일 | Phase | 변경 내용 |
|------|-------|-----------|
| `src/main/mcp-server.mjs` | 1 | Zod 스키마에 파라미터 추가, frontmatter 조합 로직 |
| `src/main/mcp-http.mjs` | 1 | JSON Schema에 파라미터 추가, frontmatter 조합 로직 |
| `src/main/window-manager.js` | 1 | createWindow/updateWindow에 파라미터 전달 (pass-through) |
| `src/main/index.js` | 1 | IPC 핸들러에 파라미터 전파 (기존 패턴대로) |
| `src/renderer/viewer.js` | 2 | renderMarkdown() 전 frontmatter 파싱 + 메타박스 렌더링 |
| `src/renderer/viewer.html` | 2 | 메타박스 컨테이너 DOM 추가 |
| `src/renderer/viewer.css` | 2 | 메타박스 스타일 (light/dark, collapsible) |
| `src/locales/ko.json` | 2 | i18n 문자열 추가 |
| `src/locales/en.json` | 2 | i18n 문자열 추가 |
| `src/locales/ja.json` | 2 | i18n 문자열 추가 |
| `src/locales/es.json` | 2 | i18n 문자열 추가 |
| `CLAUDE.md` | 3 | MCP Tools 테이블 업데이트, 호출 규칙 추가 |
