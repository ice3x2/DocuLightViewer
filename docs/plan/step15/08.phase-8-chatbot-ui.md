# Phase 8: ì±—ë´‡ UI

## 1. ëª©í‘œ ë° ë²”ìœ„

### 1.1 ëª©í‘œ
- ChatGPT/Claude ìŠ¤íƒ€ì¼ ì±—ë´‡ UI êµ¬í˜„
- Markdown ë Œë”ë§ (ì½”ë“œ ë¸”ë¡, í…Œì´ë¸”, ë¦¬ìŠ¤íŠ¸)
- ui.indexFile="CHATBOT" ì„¤ì • ì‹œ ë©”ì¸ í˜ì´ì§€ ëŒ€ì²´

### 1.2 ìš”êµ¬ì‚¬í•­ ë§¤í•‘
| ìš”êµ¬ì‚¬í•­ ID | ì„¤ëª… | ìˆ˜ìš© ê¸°ì¤€ |
|-------------|------|----------|
| FR-CB-014 | Markdown ë Œë”ë§ | ì½”ë“œ ë¸”ë¡, í…Œì´ë¸”, ë¦¬ìŠ¤íŠ¸ ë“± ì •ìƒ ë Œë”ë§ |
| FR-CB-015 | ì±—ë´‡ ë©”ì¸ í˜ì´ì§€ ì„¤ì • | ui.indexFile="CHATBOT" ì„¤ì • ì‹œ ë©”ì¸ í˜ì´ì§€ ë³€ê²½ |

### 1.3 ì„ í–‰ ì¡°ê±´
- **Phase 7 ì™„ë£Œ**: API ë° ìŠ¤íŠ¸ë¦¬ë°

### 1.4 ì•„í‚¤í…ì²˜ ì°¸ì¡°
- [00-1.architecture.md](./00-1.architecture.md) ì„¹ì…˜ 2.2 (í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸), ì„¹ì…˜ 7 (UI ì„¤ê³„)

---

## 2. êµ¬í˜„ í•­ëª© ì²´í¬ë¦¬ìŠ¤íŠ¸

### 2.1 EJS í…œí”Œë¦¿
- [ ] `src/views/chatbot.ejs` ìƒì„±
  - [ ] í—¤ë” (íƒ€ì´í‹€, Thinking ëª¨ë“œ í† ê¸€)
  - [ ] ë©”ì‹œì§€ ëª©ë¡ ì˜ì—­
  - [ ] ì›Œí¬í”Œë¡œìš° ì¸ë””ì¼€ì´í„° ì˜ì—­
  - [ ] ì…ë ¥ ì˜ì—­

### 2.2 í´ë¼ì´ì–¸íŠ¸ JavaScript
- [ ] `public/js/chatbot.js` ìƒì„±
  - [ ] ChatbotApp í´ë˜ìŠ¤
  - [ ] SSEClient - EventSource ê´€ë¦¬
  - [ ] MessageList - ë©”ì‹œì§€ ë Œë”ë§
  - [ ] MarkdownRenderer - marked + DOMPurify
  - [ ] WorkflowIndicator - ì§„í–‰ ìƒí™© í‘œì‹œ
  - [ ] InputArea - ì…ë ¥ ì²˜ë¦¬

### 2.3 CSS ìŠ¤íƒ€ì¼
- [ ] `public/css/chatbot.css` ìƒì„±
  - [ ] ë©”ì‹œì§€ ë²„ë¸” ìŠ¤íƒ€ì¼
  - [ ] ì›Œí¬í”Œë¡œìš° ì¸ë””ì¼€ì´í„° ìŠ¤íƒ€ì¼
  - [ ] ì½”ë“œ ë¸”ë¡ í•˜ì´ë¼ì´íŒ…
  - [ ] ë°˜ì‘í˜• ë””ìì¸

### 2.4 ë¼ìš°íŠ¸ ì¶”ê°€
- [ ] `src/app.js` ìˆ˜ì •
  - [ ] GET /chatbot - ì±—ë´‡ í˜ì´ì§€ ë Œë”ë§
  - [ ] ui.indexFile="CHATBOT" ì²˜ë¦¬

---

## 3. ìƒì„¸ êµ¬í˜„ ê°€ì´ë“œ

### 3.1 EJS í…œí”Œë¦¿

```html
<!-- src/views/chatbot.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= config.ui?.title || 'DocLight' %> - Chatbot</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/chatbot.css">
  <link rel="icon" href="<%= config.ui?.icon || '/images/icon.png' %>">
  <!-- Markdown rendering -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- XSS protection -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>
  <!-- Optional: Code syntax highlighting -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11/styles/github-dark.min.css">
  <script src="https://cdn.jsdelivr.net/npm/highlight.js@11"></script>
</head>
<body>
  <div class="chatbot-container">
    <!-- í—¤ë” -->
    <header class="chatbot-header">
      <h1><%= config.ui?.title || 'DocLight' %> Chatbot</h1>
      <div class="header-controls">
        <label class="thinking-toggle">
          <input type="checkbox" id="thinking-mode">
          <span>Thinking Mode</span>
        </label>
      </div>
    </header>

    <!-- ë©”ì‹œì§€ ëª©ë¡ -->
    <main class="message-list" id="message-list">
      <div class="welcome-message">
        <div class="bot-avatar">ğŸ¤–</div>
        <div class="message-content">
          <p>Hello! Ask me anything about the documents.</p>
          <p class="doc-count">ğŸ“š Documents indexed: <span id="doc-count">-</span></p>
        </div>
      </div>
    </main>

    <!-- ì›Œí¬í”Œë¡œìš° ì¸ë””ì¼€ì´í„° -->
    <div class="workflow-indicator" id="workflow-indicator" style="display: none;">
      <div class="step-icon">â³</div>
      <div class="step-message" id="step-message">Processing...</div>
    </div>

    <!-- ì…ë ¥ ì˜ì—­ -->
    <footer class="input-area">
      <form id="chat-form">
        <input
          type="text"
          id="message-input"
          placeholder="Type your message..."
          autocomplete="off"
        >
        <button type="submit" id="send-button">Send</button>
      </form>
    </footer>
  </div>

  <script src="/js/chatbot.js"></script>
</body>
</html>
```

### 3.2 í´ë¼ì´ì–¸íŠ¸ JavaScript

```javascript
// public/js/chatbot.js

/**
 * Chatbot Application
 */
class ChatbotApp {
  constructor() {
    this.threadId = null;
    this.isProcessing = false;
    this.thinkingMode = false;

    this.elements = {
      messageList: document.getElementById('message-list'),
      messageInput: document.getElementById('message-input'),
      chatForm: document.getElementById('chat-form'),
      sendButton: document.getElementById('send-button'),
      thinkingToggle: document.getElementById('thinking-mode'),
      workflowIndicator: document.getElementById('workflow-indicator'),
      stepMessage: document.getElementById('step-message'),
      docCount: document.getElementById('doc-count'),
    };

    this.init();
  }

  init() {
    this.loadStatus();
    this.bindEvents();
  }

  bindEvents() {
    this.elements.chatForm.addEventListener('submit', (e) => {
      e.preventDefault();
      this.sendMessage();
    });

    this.elements.thinkingToggle.addEventListener('change', (e) => {
      this.thinkingMode = e.target.checked;
    });
  }

  async loadStatus() {
    try {
      const res = await fetch('/api/chatbot/status');
      const status = await res.json();
      this.elements.docCount.textContent = status.vectorStore.totalDocs;
    } catch (error) {
      console.error('Failed to load status:', error);
    }
  }

  async sendMessage() {
    const message = this.elements.messageInput.value.trim();
    if (!message || this.isProcessing) return;

    this.isProcessing = true;
    this.elements.sendButton.disabled = true;
    this.elements.messageInput.value = '';

    // ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
    this.addMessage('user', message);

    // ë´‡ ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ ìƒì„±
    const botMessageEl = this.addMessage('bot', '');

    // ì›Œí¬í”Œë¡œìš° ì¸ë””ì¼€ì´í„° í‘œì‹œ
    this.showWorkflow(true);

    try {
      await this.streamResponse(message, botMessageEl);
    } catch (error) {
      this.updateMessage(botMessageEl, `Error: ${error.message}`);
    } finally {
      this.showWorkflow(false);
      this.isProcessing = false;
      this.elements.sendButton.disabled = false;
      this.elements.messageInput.focus();
    }
  }

  async streamResponse(message, messageEl) {
    return new Promise((resolve, reject) => {
      const body = JSON.stringify({
        message,
        threadId: this.threadId,
        thinkingMode: this.thinkingMode,
      });

      fetch('/api/chatbot/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body,
      }).then(response => {
        const reader = response.body.getReader();
        const decoder = new TextDecoder();
        let buffer = '';
        let content = '';

        const processChunk = ({ done, value }) => {
          if (done) {
            resolve();
            return;
          }

          buffer += decoder.decode(value, { stream: true });
          const lines = buffer.split('\n');
          buffer = lines.pop() || '';

          for (const line of lines) {
            if (line.startsWith('event: ')) {
              const eventType = line.slice(7);
              // ë‹¤ìŒ ì¤„ì´ data
            } else if (line.startsWith('data: ')) {
              try {
                const data = JSON.parse(line.slice(6));
                this.handleSSEEvent(data, messageEl, (c) => {
                  content += c;
                  this.updateMessage(messageEl, content);
                });
              } catch (e) {
                // JSON íŒŒì‹± ì‹¤íŒ¨ ë¬´ì‹œ
              }
            }
          }

          reader.read().then(processChunk);
        };

        reader.read().then(processChunk);
      }).catch(reject);
    });
  }

  handleSSEEvent(event, messageEl, appendToken) {
    switch (event.type || Object.keys(event)[0]) {
      case 'step':
        this.elements.stepMessage.textContent = event.data?.message || event.message || 'Processing...';
        break;

      case 'retrieval':
        const sources = event.data?.sources || event.sources || [];
        this.elements.stepMessage.textContent = `Found ${sources.length} relevant documents`;
        break;

      case 'token':
        const content = event.data?.content || event.content || '';
        appendToken(content);
        break;

      case 'done':
        this.threadId = event.data?.threadId || event.threadId;
        break;

      case 'error':
        const errorMsg = event.data?.message || event.message || 'Unknown error';
        throw new Error(errorMsg);
    }
  }

  addMessage(role, content) {
    const messageEl = document.createElement('div');
    messageEl.className = `message message-${role}`;

    const avatar = role === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–';

    messageEl.innerHTML = `
      <div class="${role}-avatar">${avatar}</div>
      <div class="message-content markdown-content"></div>
    `;

    if (content) {
      this.updateMessage(messageEl, content);
    }

    this.elements.messageList.appendChild(messageEl);
    this.scrollToBottom();

    return messageEl;
  }

  updateMessage(messageEl, content) {
    const contentEl = messageEl.querySelector('.message-content');

    // Markdown ë Œë”ë§
    const html = marked.parse(content);

    // XSS ë°©ì§€
    contentEl.innerHTML = DOMPurify.sanitize(html);

    // ì½”ë“œ ë¸”ë¡ í•˜ì´ë¼ì´íŒ… (ì„ íƒì )
    contentEl.querySelectorAll('pre code').forEach((block) => {
      if (window.hljs) {
        hljs.highlightBlock(block);
      }
    });

    this.scrollToBottom();
  }

  showWorkflow(show) {
    this.elements.workflowIndicator.style.display = show ? 'flex' : 'none';
  }

  scrollToBottom() {
    this.elements.messageList.scrollTop = this.elements.messageList.scrollHeight;
  }
}

// ì•± ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', () => {
  window.chatbotApp = new ChatbotApp();
});
```

### 3.3 CSS ìŠ¤íƒ€ì¼

```css
/* public/css/chatbot.css */

.chatbot-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  max-width: 900px;
  margin: 0 auto;
  background: var(--bg-primary, #ffffff);
}

.chatbot-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  border-bottom: 1px solid var(--border-color, #e0e0e0);
}

.chatbot-header h1 {
  font-size: 1.25rem;
  margin: 0;
}

.thinking-toggle {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
}

.message-list {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
}

.message {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
  max-width: 85%;
}

.message-user {
  flex-direction: row-reverse;
  margin-left: auto;
}

.message-bot {
  margin-right: auto;
}

.user-avatar, .bot-avatar {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.25rem;
  flex-shrink: 0;
}

.message-content {
  padding: 0.75rem 1rem;
  border-radius: 1rem;
  line-height: 1.5;
}

.message-user .message-content {
  background: var(--primary-color, #007bff);
  color: white;
  border-bottom-right-radius: 0.25rem;
}

.message-bot .message-content {
  background: var(--bg-secondary, #f5f5f5);
  border-bottom-left-radius: 0.25rem;
}

/* ì½”ë“œ ë¸”ë¡ */
.message-content pre {
  background: #1e1e1e;
  color: #d4d4d4;
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  margin: 0.5rem 0;
}

.message-content code {
  font-family: 'Fira Code', monospace;
  font-size: 0.9em;
}

/* ì›Œí¬í”Œë¡œìš° ì¸ë””ì¼€ì´í„° */
.workflow-indicator {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1rem;
  background: var(--bg-secondary, #f5f5f5);
  border-top: 1px solid var(--border-color, #e0e0e0);
}

.step-icon {
  animation: pulse 1s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ì…ë ¥ ì˜ì—­ */
.input-area {
  padding: 1rem;
  border-top: 1px solid var(--border-color, #e0e0e0);
}

#chat-form {
  display: flex;
  gap: 0.5rem;
}

#message-input {
  flex: 1;
  padding: 0.75rem 1rem;
  border: 1px solid var(--border-color, #e0e0e0);
  border-radius: 1.5rem;
  font-size: 1rem;
  outline: none;
}

#message-input:focus {
  border-color: var(--primary-color, #007bff);
}

#send-button {
  padding: 0.75rem 1.5rem;
  background: var(--primary-color, #007bff);
  color: white;
  border: none;
  border-radius: 1.5rem;
  cursor: pointer;
  font-size: 1rem;
}

#send-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ë°˜ì‘í˜• */
@media (max-width: 768px) {
  .message {
    max-width: 95%;
  }
}
```

### 3.4 ë¼ìš°íŠ¸ ì¶”ê°€

```javascript
// src/app.js (ìˆ˜ì •)

// ì±—ë´‡ í˜ì´ì§€ ë¼ìš°íŠ¸
app.get('/chatbot', (req, res) => {
  res.render('chatbot', { config });
});

// ui.indexFile="CHATBOT" ì²˜ë¦¬
if (config.ui?.indexFile === 'CHATBOT') {
  app.get('/', (req, res) => {
    res.redirect('/chatbot');
  });
}
```

---

## 4. í…ŒìŠ¤íŠ¸ ì„¹ì…˜

### 4.1 í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### TC-CB-014: Markdown ë Œë”ë§
```gherkin
Given ë´‡ì´ Markdown í˜•ì‹ ì‘ë‹µì„ ìƒì„±í•¨
When ì‘ë‹µì´ UIì— ë Œë”ë§ë¨
Then ì½”ë“œ ë¸”ë¡ì´ í•˜ì´ë¼ì´íŒ…ë¨
  And í…Œì´ë¸”ì´ ì •ìƒ í‘œì‹œë¨
  And ë¦¬ìŠ¤íŠ¸ê°€ ì •ìƒ í‘œì‹œë¨
  And XSS ê³µê²©ì´ ì°¨ë‹¨ë¨
```

#### TC-CB-015: ì±—ë´‡ ë©”ì¸ í˜ì´ì§€
```gherkin
Given ui.indexFile="CHATBOT"ìœ¼ë¡œ ì„¤ì •ë¨
When ì‚¬ìš©ìê°€ / ê²½ë¡œì— ì ‘ì†í•¨
Then /chatbotìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¨
```

---

## 5. ì˜ˆìƒ ì‚°ì¶œë¬¼

```
src/
â””â”€â”€ views/
    â””â”€â”€ chatbot.ejs

public/
â”œâ”€â”€ js/
â”‚   â””â”€â”€ chatbot.js
â””â”€â”€ css/
    â””â”€â”€ chatbot.css
```

---

## 6. ì…ë ¥ ê²€ì¦ ë° ì—ëŸ¬ ì²˜ë¦¬

### 6.1 í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì…ë ¥ ê²€ì¦

```javascript
// public/js/chatbot.js - ì…ë ¥ ê²€ì¦ ì¶”ê°€

class InputValidator {
  static MAX_MESSAGE_LENGTH = 4000;
  static MIN_MESSAGE_LENGTH = 1;

  /**
   * ë©”ì‹œì§€ ìœ íš¨ì„± ê²€ì¦
   * @param {string} message - ê²€ì¦í•  ë©”ì‹œì§€
   * @returns {{ valid: boolean, error?: string }}
   */
  static validateMessage(message) {
    if (!message || typeof message !== 'string') {
      return { valid: false, error: 'Message is required' };
    }

    const trimmed = message.trim();

    if (trimmed.length < this.MIN_MESSAGE_LENGTH) {
      return { valid: false, error: 'Message cannot be empty' };
    }

    if (trimmed.length > this.MAX_MESSAGE_LENGTH) {
      return {
        valid: false,
        error: `Message too long (max ${this.MAX_MESSAGE_LENGTH} characters)`
      };
    }

    return { valid: true };
  }

  /**
   * XSS ë°©ì§€ë¥¼ ìœ„í•œ ì…ë ¥ ì´ìŠ¤ì¼€ì´í”„ (í‘œì‹œìš©)
   * ì£¼ì˜: ì„œë²„ë¡œ ì „ì†¡í•˜ëŠ” ë©”ì‹œì§€ëŠ” ì›ë³¸ ê·¸ëŒ€ë¡œ ì „ì†¡
   */
  static escapeForDisplay(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
}
```

### 6.2 ì—ëŸ¬ ì²˜ë¦¬ ë° ì‚¬ìš©ì í”¼ë“œë°±

```javascript
// public/js/chatbot.js - ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”

class ErrorHandler {
  static ERROR_MESSAGES = {
    'RATE_LIMITED': 'Too many requests. Please wait a moment.',
    'SERVICE_UNAVAILABLE': 'Chatbot service is not available. Please try again later.',
    'LLM_ERROR': 'Failed to generate response. Please try again.',
    'NETWORK_ERROR': 'Network error. Please check your connection.',
    'TIMEOUT': 'Request timed out. Please try again.',
  };

  /**
   * ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
   * @param {Error|Object} error - ì—ëŸ¬ ê°ì²´
   * @param {HTMLElement} messageEl - ë©”ì‹œì§€ ì—˜ë¦¬ë¨¼íŠ¸
   */
  static handleError(error, messageEl) {
    const errorCode = error.code || 'UNKNOWN_ERROR';
    const errorMessage = this.ERROR_MESSAGES[errorCode] || error.message || 'An unexpected error occurred';

    const errorHtml = `
      <div class="error-message">
        <span class="error-icon">âš ï¸</span>
        <span class="error-text">${this.escapeHtml(errorMessage)}</span>
        ${error.retryAfter ? `<span class="retry-info">Retry in ${error.retryAfter}s</span>` : ''}
      </div>
    `;

    messageEl.querySelector('.message-content').innerHTML = errorHtml;
  }

  static escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }
}

// CSS for error messages
// public/css/chatbot.cssì— ì¶”ê°€
/*
.error-message {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: #dc3545;
  padding: 0.75rem;
  background: #f8d7da;
  border-radius: 0.5rem;
}

.error-icon {
  font-size: 1.25rem;
}

.retry-info {
  font-size: 0.875rem;
  color: #6c757d;
  margin-left: auto;
}
*/
```

### 6.3 ì—°ê²° ìƒíƒœ ê´€ë¦¬

```javascript
// public/js/chatbot.js - ì—°ê²° ìƒíƒœ ê´€ë¦¬

class ConnectionManager {
  constructor() {
    this.isOnline = navigator.onLine;
    this.retryCount = 0;
    this.maxRetries = 3;
    this.retryDelay = 1000;

    window.addEventListener('online', () => this.handleOnline());
    window.addEventListener('offline', () => this.handleOffline());
  }

  handleOnline() {
    this.isOnline = true;
    this.showStatus('Connected', 'success');
  }

  handleOffline() {
    this.isOnline = false;
    this.showStatus('No internet connection', 'error');
  }

  showStatus(message, type) {
    // ìƒíƒœ í‘œì‹œ UI ì—…ë°ì´íŠ¸
    const statusEl = document.getElementById('connection-status');
    if (statusEl) {
      statusEl.textContent = message;
      statusEl.className = `connection-status ${type}`;
    }
  }

  async fetchWithRetry(url, options) {
    if (!this.isOnline) {
      throw new Error('NETWORK_ERROR: No internet connection');
    }

    for (let i = 0; i <= this.maxRetries; i++) {
      try {
        const response = await fetch(url, {
          ...options,
          signal: AbortSignal.timeout(30000) // 30ì´ˆ íƒ€ì„ì•„ì›ƒ
        });

        if (response.ok || response.status === 429) {
          return response;
        }

        throw new Error(`HTTP ${response.status}`);
      } catch (error) {
        if (i === this.maxRetries) {
          throw error;
        }

        // ì§€ìˆ˜ ë°±ì˜¤í”„
        await new Promise(r => setTimeout(r, this.retryDelay * Math.pow(2, i)));
      }
    }
  }
}
```

---

## 7. ì ‘ê·¼ì„±(Accessibility) ë° UX ê³ ë ¤ì‚¬í•­

### 7.1 í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜

```javascript
// í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì§€ì›
document.addEventListener('keydown', (e) => {
  // Ctrl/Cmd + Enterë¡œ ì „ì†¡
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    document.getElementById('chat-form').dispatchEvent(new Event('submit'));
  }

  // Escapeë¡œ ì…ë ¥ ì·¨ì†Œ
  if (e.key === 'Escape') {
    document.getElementById('message-input').value = '';
    document.getElementById('message-input').focus();
  }
});
```

### 7.2 ARIA ë ˆì´ë¸”

```html
<!-- ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì› -->
<main class="message-list" id="message-list" role="log" aria-live="polite" aria-label="Chat messages">
  <!-- ë©”ì‹œì§€ë“¤ -->
</main>

<div class="workflow-indicator" role="status" aria-live="polite" aria-label="Processing status">
  <!-- ìƒíƒœ í‘œì‹œ -->
</div>

<input
  type="text"
  id="message-input"
  aria-label="Type your message"
  aria-describedby="input-hint"
>
<span id="input-hint" class="visually-hidden">Press Enter to send, Escape to clear</span>
```

### 7.3 ë¡œë”© ìƒíƒœ í‘œì‹œ

```css
/* ë¡œë”© ìƒíƒœ ìŠ¤íƒ€ì¼ */
.message-bot.loading .message-content::after {
  content: '...';
  animation: typing 1.5s steps(3) infinite;
}

@keyframes typing {
  0% { content: '.'; }
  33% { content: '..'; }
  66% { content: '...'; }
}

/* ì „ì†¡ ë²„íŠ¼ ë¡œë”© ìƒíƒœ */
#send-button.loading {
  position: relative;
  color: transparent;
}

#send-button.loading::after {
  content: '';
  position: absolute;
  width: 1rem;
  height: 1rem;
  border: 2px solid #fff;
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
```

---

## 8. ì™„ë£Œ ê¸°ì¤€

- [ ] ì±—ë´‡ UI í˜ì´ì§€ ë Œë”ë§
- [ ] ë©”ì‹œì§€ ì†¡ìˆ˜ì‹  ì •ìƒ ë™ì‘
- [ ] Markdown ë Œë”ë§ ì •ìƒ ë™ì‘
- [ ] XSS ë°©ì§€ í™•ì¸
- [ ] ui.indexFile="CHATBOT" ë™ì‘
- [ ] ë°˜ì‘í˜• ë””ìì¸ í™•ì¸
- [ ] ì…ë ¥ ê²€ì¦ ë™ì‘ í™•ì¸
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ì‚¬ìš©ì í”¼ë“œë°± ë™ì‘ í™•ì¸
- [ ] í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ë™ì‘ í™•ì¸
- [ ] ê²€ì¦ ë¬¸ì„œ ì‘ì„± ì™„ë£Œ
